{% extends "base.html" %}

{% block title %}Stellenangebote - JobTracker{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 py-8">
    <div class="mb-6">
        <h1 class="text-2xl font-bold mb-1">Stellenangebote</h1>
        <p class="text-dark-muted text-sm">
            {% if jobs and jobs|length > 0 %}
                {{ jobs|length }} Stelle{{ 'n' if jobs|length != 1 else '' }} gefunden
            {% else %}
                Keine Jobs gefunden
            {% endif %}
        </p>
    </div>

    {% if not jobs or jobs|length == 0 %}
        <div class="card text-center py-12">
            <p class="text-dark-muted mb-4">Keine Jobs verf√ºgbar</p>
            <a href="/search_job" class="btn-primary">Jobs suchen</a>
        </div>
    {% else %}
        <div class="grid md:grid-cols-2 gap-4">
            {% for job in jobs %}
                {% set jid = job.get('id') if job.get('id') is not none else loop.index %}
                <div class="job-card">
                    <p class="text-blue-400 text-sm mb-1">{{ job.get('company') or 'Unbekannt' }}</p>
                    <h3 class="font-semibold mb-2">{{ job.get('title') or job.get('name') or 'Ohne Titel' }}</h3>

                    <p class="text-dark-muted text-sm mb-3">
                        {% if job.get('location') %}{{ job.get('location') }}{% endif %}
                        {% if job.get('job_type') %} &bull; {{ job.get('job_type') }}{% endif %}
                    </p>

                    <p class="text-dark-muted text-sm mb-4 line-clamp-2">{{ job.get('description', '')|truncate(100) }}</p>

                    <div class="flex gap-2 pt-3 border-t border-dark-border">
                        <a href="/job/{{ jid }}" class="btn-primary text-sm flex-1 text-center">Ansehen</a>
                        <form method="POST" action="/jobs/favorites">
                            <input type="hidden" name="job_id" value="{{ jid }}">
                            <button type="submit" class="btn-secondary text-sm">Speichern</button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <div class="mt-6">
        <a href="/search_job" class="text-dark-muted hover:text-dark-text text-sm">&larr; Neue Suche</a>
    </div>
</div>
{% endblock %}
